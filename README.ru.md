# openapi2mcp

[Read in English](README.md)

Инструмент для преобразования спецификаций OpenAPI 3.x в серверы FastMCP.

## Установка

```bash
poetry install
```

## Использование / Команды

`openapi2mcp` предоставляет интерфейс командной строки для генерации и управления кодом MCP-сервера из спецификаций OpenAPI.

### `generate`

Генерирует Python-код MCP-сервера из файла спецификации OpenAPI.

**Синтаксис:**

```bash
openapi2mcp generate [OPTIONS]
```

**Опции:**

*   `-i, --input-file PATH`: Путь к файлу спецификации OpenAPI (JSON или YAML). (Обязательный)
*   `-o, --output-file PATH`: Путь к выходному Python-файлу для сгенерированного MCP-сервера. (Обязательный)
*   `-t, --transport [stdio|google_pubsub]`: Транспортный механизм для MCP-сервера. (По умолчанию: `stdio`)
*   `--llms-txt-file PATH`: Необязательный путь для генерации файла `llms.txt`, который предоставляет описание сгенерированных инструментов и ресурсов для языковых моделей. Если не указан, `llms.txt` будет создан в той же директории, что и выходной файл сервера.
*   `--mount TEXT`: Необязательный путь монтирования для ресурсов (например, `/myapi/v1`). (По умолчанию: `""`)

**Пример:**

```bash
openapi2mcp generate --input-file examples/example_openapi.yaml --output-file generated_server.py --transport stdio --mount "/api"
```

Эта команда разберет `examples/example_openapi.yaml`, сгенерирует файл MCP-сервера с именем `generated_server.py`, используя транспорт `stdio`, и установит путь монтирования ресурсов на `/api`. Она также сгенерирует файл `llms.txt` в той же директории, что и `generated_server.py`.

### `check`

Проверяет сгенерированный Python-файл MCP-сервера на базовую корректность кода, включая синтаксис и наличие ключевых шаблонов MCP.

**Синтаксис:**

```bash
openapi2mcp check --server-file PATH
```

**Опции:**

*   `--server-file PATH`: Путь к сгенерированному Python-файлу MCP-сервера для проверки. (Обязательный)

**Пример:**

```bash
openapi2mcp check --server-file generated_server.py
```

### `version`

Отображает версию инструмента `openapi2mcp`.

**Синтаксис:**

```bash
openapi2mcp version
```

**Пример:**

```bash
openapi2mcp version
```

## Примеры

Смотрите примеры реализации:
- [HTTP Сервер](examples/server_http.py)
- [SSE Сервер](examples/server_sse.py)
- [STDIO Сервер](examples/server_stdio.py)
- [Пример спецификации OpenAPI](examples/example_openapi.yaml)

## Структура проекта

- `openapi2mcp/parser.py`: Парсер спецификации OpenAPI
- `openapi2mcp/generator.py`: Генератор кода сервера FastMCP
- `openapi2mcp/cli.py`: Интерфейс командной строки

## Архитектура

Проект состоит из трех основных компонентов:

*   `parser.py`: Этот модуль отвечает за чтение и разбор файла спецификации OpenAPI 3.x. Он проверяет структуру и извлекает релевантную информацию о путях, операциях, схемах и параметрах.
*   `generator.py`: Этот модуль принимает разобранные данные OpenAPI и генерирует Python-код для сервера FastMCP. Он сопоставляет операции OpenAPI с ресурсами и методами MCP, создавая необходимые обработчики и структуры данных.
*   `cli.py`: Этот модуль предоставляет интерфейс командной строки для инструмента, позволяя пользователям вызывать процесс генерации и другие служебные функции, такие как проверка сгенерированного кода сервера или отображение версии инструмента.

## Основные принципы работы

Общий рабочий процесс `openapi2mcp` выглядит следующим образом:

1.  **Входная спецификация OpenAPI**: Пользователь предоставляет файл спецификации OpenAPI 3.x (в формате JSON или YAML), описывающий его API.
2.  **Разбор (Парсинг)**: Модуль `parser.py` читает эту спецификацию и преобразует ее во внутреннее представление, облегчая генератору понимание структуры API.
3.  **Генерация кода**: Модуль `generator.py` обрабатывает это внутреннее представление. Он перебирает пути и операции API, генерируя соответствующие ресурсы FastMCP и Python-функции. Он также обрабатывает преобразование схем OpenAPI в модели Pydantic для валидации запросов и ответов.
4.  **Выходной MCP-сервер**: Результатом является Python-файл, содержащий полнофункциональный сервер FastMCP. Этот сервер затем можно запустить, используя подходящий транспорт MCP (например, STDIO или Google Pub/Sub).
5.  **Описание для LLM (Опционально)**: Вместе с сервером может быть сгенерирован файл `llms.txt`. Этот файл предоставляет описание на естественном языке инструментов (конечных точек API) и ресурсов, доступных в сгенерированном сервере, что может быть полезно для интеграции с большими языковыми моделями.

## Кастомизация

Сгенерированный код MCP-сервера — это стандартный код Python и FastMCP. Это означает, что вы можете:

*   **Изменять сгенерированный код**: Не стесняйтесь редактировать выходной Python-файл, чтобы настроить логику, добавить пользовательскую обработку ошибок или интегрировать дополнительные функции, не охваченные спецификацией OpenAPI.
*   **Расширять функциональность**: Вы можете добавлять новые ресурсы или методы MCP к сгенерированному серверу, или импортировать и использовать другие библиотеки Python в коде вашего сервера.
*   **Изменять транспорт или промежуточное ПО**: Хотя транспорт выбирается во время генерации, вы можете вручную настроить конфигурацию сервера или добавить промежуточное ПО FastMCP по мере необходимости.

<!-- Добавить значок версии PyPI здесь -->
<!-- Добавить значок лицензии здесь -->
<!-- Добавить другие релевантные значки здесь (например, статус сборки, покрытие кода) -->

## Лицензия

MIT - Смотрите [LICENSE](LICENSE)
